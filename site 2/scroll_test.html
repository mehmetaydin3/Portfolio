<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Scroll Lock Test</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>tailwind.config = { darkMode: 'class' }</script>
  <style>
    /* Normal backgrounds */
    html:not(.dark) .gradient-bg-light {
      background: linear-gradient(-45deg, #f8f9fa, #f5f6f7, #f2f3f4, #eeeff0, #ebeced, #e8e9ea);
      background-size: 200% 200%;
      animation: gradientShift 10s ease-in-out infinite;
    }

    html.dark .gradient-bg-dark {
      background: linear-gradient(135deg, #111827 0%, #1a1f2e 20%, #1e2332 40%, #1a1f2e 60%, #16202b 80%, #111827 100%);
      background-size: 200% 200%;
      animation: gradientShift 10s ease-in-out infinite;
    }

    @keyframes gradientShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    /* Drawer lock styles */
    body.drawer-open {
      position: fixed !important;
      top: var(--scroll-position, 0) !important;
      left: 0 !important;
      right: 0 !important;
      width: 100% !important;
      height: 100vh !important;
      overflow: hidden !important;
    }

    /* Test: Remove background-attachment to see if that's the issue */
    html:not(.dark) .gradient-bg-light.drawer-open {
      background: linear-gradient(-45deg, #f8f9fa, #f5f6f7, #f2f3f4, #eeeff0, #ebeced, #e8e9ea) !important;
      background-size: 200% 200% !important;
      animation: gradientShift 10s ease-in-out infinite !important;
      /* Removed background-attachment: fixed to test */
    }

    html.dark .gradient-bg-dark.drawer-open {
      background: linear-gradient(135deg, #111827 0%, #1a1f2e 20%, #1e2332 40%, #1a1f2e 60%, #16202b 80%, #111827 100%) !important;
      background-size: 200% 200% !important;
      animation: gradientShift 10s ease-in-out infinite !important;
      /* Removed background-attachment: fixed to test */
    }
  </style>
</head>
<body class="gradient-bg-light gradient-bg-dark text-black dark:text-white">
  <div class="p-8 space-y-4">
    <h1 class="text-2xl font-bold">Scroll Lock Test</h1>
    <p>Theme: <span id="theme">Dark</span></p>
    <button id="toggle" class="bg-blue-500 text-white px-4 py-2 rounded">Toggle Theme</button>
    <button id="open" class="bg-green-500 text-white px-4 py-2 rounded">Open Drawer</button>
    
    <!-- Generate content to scroll -->
    <div class="space-y-4">
      <div class="h-96 bg-red-200 dark:bg-red-800 p-4 rounded">Section 1</div>
      <div class="h-96 bg-blue-200 dark:bg-blue-800 p-4 rounded">Section 2</div>
      <div class="h-96 bg-green-200 dark:bg-green-800 p-4 rounded">Section 3</div>
      <div class="h-96 bg-yellow-200 dark:bg-yellow-800 p-4 rounded">Section 4</div>
    </div>
  </div>

  <!-- Overlay -->
  <div id="overlay" class="fixed inset-0 bg-black/20 backdrop-blur-md z-40 hidden"></div>
  
  <!-- Drawer -->
  <div id="drawer" class="fixed bottom-0 left-1/2 w-[90%] h-[90vh] bg-white dark:bg-gray-800 rounded-t-[24px] shadow-2xl translate-y-full -translate-x-1/2 transition-transform duration-500 z-50 overflow-y-auto">
    <div class="p-6 space-y-4">
      <div class="flex justify-between items-center">
        <h2 class="text-xl font-bold">Test Drawer</h2>
        <button id="close" class="bg-red-500 text-white px-3 py-1 rounded">Close</button>
      </div>
      <p>Scroll this content and check if background moves:</p>
      
      <!-- Drawer content to scroll -->
      <div class="space-y-4">
        <div class="h-64 bg-purple-200 dark:bg-purple-800 p-4 rounded">Drawer Section 1</div>
        <div class="h-64 bg-pink-200 dark:bg-pink-800 p-4 rounded">Drawer Section 2</div>
        <div class="h-64 bg-indigo-200 dark:bg-indigo-800 p-4 rounded">Drawer Section 3</div>
        <div class="h-64 bg-orange-200 dark:bg-orange-800 p-4 rounded">Drawer Section 4</div>
        <div class="h-64 bg-teal-200 dark:bg-teal-800 p-4 rounded">Drawer Section 5</div>
      </div>
    </div>
  </div>

  <script>
    let scrollPosition = 0;

    function lockBodyScroll() {
      scrollPosition = window.pageYOffset;
      console.log('Locking scroll at position:', scrollPosition);
      document.body.style.setProperty('--scroll-position', `-${scrollPosition}px`);
      document.body.classList.add('drawer-open');
    }

    function unlockBodyScroll() {
      console.log('Unlocking scroll, returning to position:', scrollPosition);
      document.body.classList.remove('drawer-open');
      document.body.style.removeProperty('--scroll-position');
      window.scrollTo(0, scrollPosition);
    }

    document.getElementById('toggle').addEventListener('click', () => {
      document.documentElement.classList.toggle('dark');
      document.getElementById('theme').textContent = 
        document.documentElement.classList.contains('dark') ? 'Dark' : 'Light';
    });

    document.getElementById('open').addEventListener('click', () => {
      document.getElementById('overlay').classList.remove('hidden');
      document.getElementById('drawer').classList.remove('translate-y-full');
      lockBodyScroll();
    });

    document.getElementById('close').addEventListener('click', () => {
      document.getElementById('overlay').classList.add('hidden');
      document.getElementById('drawer').classList.add('translate-y-full');
      unlockBodyScroll();
    });

    // Add scroll event listener to test if background is moving
    window.addEventListener('scroll', () => {
      console.log('Window scroll detected at:', window.pageYOffset);
    });
  </script>
</body>
</html>